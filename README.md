# 一、促销与订单的交互
1. 在促销规则界面定制好促销内容->生成促销公式
2. 从订单数据中抽取促销公式所需要的数据->生成促销参数（一般是：商品数量(c)、商品价格(p)）
3. 把促销公式和促销参数丢进ScriptEngine运算，看结果的真假
4. 根据第三步的结果来决定是否要对订单执行相应的减价动作

# 二、促销展示
## 2.1、 真正商品上显示促销信息
1. 系统定时遍历所有促销，建立<商品id-促销列表>的映射
2. 在拉取商品时，从第一步中的映射中根据商品ID匹配相关促销信息
3. 一个商品ID可能会匹配到多个有效促销，此时取最优惠的
> 也就是说促销服务需要提供一个根据商品ID查询促销信息的接口

## 2.2、套装促销展示
1. Promotion实例中提供获取此促销对应的的促销虚拟商品的接口，虚拟商品并不是真正的商品，它只是根据促销信息生成的类似于真正商品的条目信息，它的属性是真正商品属性的子集，可以兼容展示在真正商品展示的位置
2. 促销虚拟商品的详情是促销信息中的商品信息，且进入促销虚拟商品详情页面时，需要实时同步对应的真实商品的库存和价格

## 2.3、套装促销下单
只需要根据促销信息中配置的最小满足条件来生成订单即可，也可以提供给用户修改的空间，但不能低于最小条件


## 2.4、促销形式
1. 满减 &radic;
2. 满折 &radic;
3. 满送商品 &radic;
4. 满送券 &radic;
5. 买几送几<sup><sup><sup>例如：买2送1</sup></sup></sup> &radic; 其实可以归类为满送商品 
6. 打包固定价格 &radic;

注；以上的“满”可能指价格满，也可以是商品数量满